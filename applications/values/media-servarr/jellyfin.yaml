# Default library values
nameOverride: 'jellyfin'

#
# Application Config
#
application:
  # Main application web UI port
  port: 8096
  # Access url base
  urlBase: 'jellyfin'
  # ConfigMap for core application settings
  config:
  # Network Options
  - filename: 'network.xml'
    contents: |
      <?xml version="1.0" encoding="utf-8"?>
      <NetworkConfiguration xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
        <BaseUrl>jellyfin</BaseUrl>
        <HttpServerPortNumber>8096</HttpServerPortNumber>
        <EnableHttps>false</EnableHttps>
        <PublicPort>8096</PublicPort>
        <EnableRemoteAccess>true</EnableRemoteAccess>
      </NetworkConfiguration>
    mountPath: '/config/config/network.xml'
  - filename: 'system.xml'
    contents: |
      <?xml version="1.0" encoding="utf-8"?>
      <ServerConfiguration xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
        <EnableMetrics>true</EnableMetrics>
        <PreferredMetadataLanguage>en</PreferredMetadataLanguage>
        <MetadataCountryCode>GB</MetadataCountryCode>
        <UICulture>en-GB</UICulture>
        <IsStartupWizardCompleted>true</IsStartupWizardCompleted>
      </ServerConfiguration>
    mountPath: '/config/config/system.xml'
  #
  # Resource - DEPLOYMENT
  # This is to set up and define the application deployment
  #
deployment:
  container:
    image:
      repository: 'jellyfin/jellyfin'

    # Additional volumeMounts on the output Deployment definition.
    volumeMounts:
    - name: 'config'
      mountPath: '/config'
    - name: 'ebooks'
      mountPath: '/ebooks'
    - name: 'film'
      mountPath: '/film'
    - name: 'music'
      mountPath: '/music'
    - name: 'television'
      mountPath: '/tv'

  volumes:
    config:
      persistentVolumeClaim:
        claimName: 'jellyfin-config'
    ebooks:
      persistentVolumeClaim:
        claimName: 'jellyfin-ebooks'
    film:
      persistentVolumeClaim:
        claimName: 'jellyfin-film'
    music:
      persistentVolumeClaim:
        claimName: 'jellyfin-music'
    television:
      persistentVolumeClaim:
        claimName: 'jellyfin-television'

persistentVolumeClaims:
  jellyfin-config:
    accessMode: 'ReadWriteOnce'
    requestStorage: '512Mi'
    selector: {}
  jellyfin-ebooks:
    accessMode: 'ReadWriteOnce'
    requestStorage: '10Gi'
    selector: {}
  jellyfin-film:
    accessMode: 'ReadWriteOnce'
    requestStorage: '20Gi'
  jellyfin-music:
    accessMode: 'ReadWriteOnce'
    requestStorage: '1Gi'
  jellyfin-television:
    accessMode: 'ReadWriteOnce'
    requestStorage: '1Gi'

ingress:
  enabled: true
  hosts:
  - "jellyfin.katedra.cc"
  - "jellyfin.katedra.kys"
  tls:
    hosts:
    - "jellyfin.katedra.cc"
    - "jellyfin.katedra.kys"
    secretName: 'wildcard-katedra-tls'

# Metrics are enable within config - add <EnableMetrics>true</EnableMetrics> to /config/config/system.xml
# metrics:
#   enabled: false
